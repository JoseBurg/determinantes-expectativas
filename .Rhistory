) |>
as_tibble() |>
pivot_longer(everything(), names_to = "nombre_variable", values_to = "valor") |>
separate(nombre_variable, into = c("grupo", "condicion1", "condicion2"), fill = "right", sep = "_") |>
mutate(
condicion = ifelse(is.na(condicion2), condicion1, paste(condicion1, condicion2, sep = "_"))
)
df_full |>
summarise(
across(bancos:otros, list(
total = ~mean(., na.rm = TRUE),
alta_vol = ~mean(.[alta_vol], na.rm = TRUE),
baja_vol = ~mean(.[!alta_vol], na.rm = TRUE),
alta_inf = ~mean(.[alta_inf], na.rm = TRUE),
baja_inf = ~mean(.[!alta_inf], na.rm = TRUE)
), .names = "{.col}_{.fn}")
) |>
as_tibble() |>
pivot_longer(everything(), names_to = "nombre_variable", values_to = "valor") |>
separate(nombre_variable, into = c("grupo", "condicion1", "condicion2"), fill = "right", sep = "_") |>
mutate(
condicion = ifelse(is.na(condicion2), condicion1, paste(condicion1, condicion2, sep = "_"))
)
# tabla_resultado <-
df_full |>
rename("organimosMultilaterales" = organismos_multilaterales) |>
summarise(
across(bancos:otros, list(
total = ~mean(., na.rm = TRUE),
alta_vol = ~mean(.[alta_vol], na.rm = TRUE),
baja_vol = ~mean(.[!alta_vol], na.rm = TRUE),
alta_inf = ~mean(.[alta_inf], na.rm = TRUE),
baja_inf = ~mean(.[!alta_inf], na.rm = TRUE)
), .names = "{.col}_{.fn}")
) |>
as_tibble() |>
pivot_longer(everything(), names_to = "nombre_variable", values_to = "valor") |>
separate(nombre_variable, into = c("grupo", "condicion1", "condicion2"), fill = "right", sep = "_") |>
mutate(
condicion = ifelse(is.na(condicion2), condicion1, paste(condicion1, condicion2, sep = "_"))
) %>%
select(grupo, condicion, valor)
# ---------------------------------------------
# PASO 7 (Opcional): Visualizar resultados
# ---------------------------------------------
ggplot(tabla_resultado, aes(x = grupo, y = total)) +
geom_col(fill = "steelblue") +
labs(title = "Sesgo sistemático promedio en la persistencia",
x = "Grupo",
y = "Sesgo de persistencia promedio") +
theme_minimal()
# tabla_resultado <-
df_full |>
rename("organimosMultilaterales" = organismos_multilaterales) |>
summarise(
across(bancos:otros, list(
total = ~mean(., na.rm = TRUE),
alta_vol = ~mean(.[alta_vol], na.rm = TRUE),
baja_vol = ~mean(.[!alta_vol], na.rm = TRUE),
alta_inf = ~mean(.[alta_inf], na.rm = TRUE),
baja_inf = ~mean(.[!alta_inf], na.rm = TRUE)
), .names = "{.col}_{.fn}")
) |>
as_tibble() |>
pivot_longer(everything(), names_to = "nombre_variable", values_to = "valor") |>
separate(nombre_variable, into = c("grupo", "condicion1", "condicion2"), fill = "right", sep = "_") |>
mutate(
condicion = ifelse(is.na(condicion2), condicion1, paste(condicion1, condicion2, sep = "_"))
) %>%
select(grupo, condicion, valor)
# tabla_resultado <-
df_full |>
rename("organimosMultilaterales" = organismos_multilaterales) |>
summarise(
across(bancos:otros, list(
total = ~mean(., na.rm = TRUE),
alta_vol = ~mean(.[alta_vol], na.rm = TRUE),
baja_vol = ~mean(.[!alta_vol], na.rm = TRUE),
alta_inf = ~mean(.[alta_inf], na.rm = TRUE),
baja_inf = ~mean(.[!alta_inf], na.rm = TRUE)
), .names = "{.col}_{.fn}")
) |>
as_tibble() |>
pivot_longer(everything(), names_to = "nombre_variable", values_to = "valor") |>
separate(nombre_variable, into = c("grupo", "condicion1", "condicion2"), fill = "right", sep = "_") |>
mutate(
condicion = ifelse(is.na(condicion2), condicion1, paste(condicion1, condicion2, sep = "_"))
) %>%
dplyr::select(grupo, condicion, valor)
# tabla_resultado <-
df_full |>
rename("organimosMultilaterales" = organismos_multilaterales) |>
summarise(
across(bancos:otros, list(
total = ~mean(., na.rm = TRUE),
alta_vol = ~mean(.[alta_vol], na.rm = TRUE),
baja_vol = ~mean(.[!alta_vol], na.rm = TRUE),
alta_inf = ~mean(.[alta_inf], na.rm = TRUE),
baja_inf = ~mean(.[!alta_inf], na.rm = TRUE)
), .names = "{.col}_{.fn}")
) |>
as_tibble() |>
pivot_longer(everything(), names_to = "nombre_variable", values_to = "valor") |>
separate(nombre_variable, into = c("grupo", "condicion1", "condicion2"), fill = "right", sep = "_") |>
mutate(
condicion = ifelse(is.na(condicion2), condicion1, paste(condicion1, condicion2, sep = "_"))
) %>%
dplyr::select(grupo, condicion, valor) |>
pivot_wider(
id_cols = grupo,
names_from = condicion,
values_from = valor
)
# tabla_resultado <-
df_full |>
rename("organimosMultilaterales" = organismos_multilaterales) |>
summarise(
across(bancos:otros, list(
total = ~mean(., na.rm = TRUE),
alta_vol = ~mean(.[alta_vol], na.rm = TRUE),
baja_vol = ~mean(.[!alta_vol], na.rm = TRUE),
alta_inf = ~mean(.[alta_inf], na.rm = TRUE),
baja_inf = ~mean(.[!alta_inf], na.rm = TRUE)
), .names = "{.col}_{.fn}")
) |>
as_tibble() |>
pivot_longer(everything(), names_to = "nombre_variable", values_to = "valor") |>
separate(nombre_variable, into = c("grupo", "condicion1", "condicion2"), fill = "right", sep = "_") |>
mutate(
condicion = ifelse(is.na(condicion2), condicion1, paste(condicion1, condicion2, sep = "_"))
) %>%
dplyr::select(grupo, condicion, valor) |>
pivot_wider(
id_cols = grupo,
names_from = condicion,
values_from = valor
)
# ---------------------------------------------
# PASO 7 (Opcional): Visualizar resultados
# ---------------------------------------------
ggplot(tabla_resultado, aes(x = grupo, y = total)) +
geom_col(fill = "steelblue") +
labs(title = "Sesgo sistemático promedio en la persistencia",
x = "Grupo",
y = "Sesgo de persistencia promedio") +
theme_minimal()
tabla_resultado |> clipr::write_clip()
tabla_resultado <-
df_full |>
rename("organimosMultilaterales" = organismos_multilaterales) |>
summarise(
across(bancos:otros, list(
total = ~mean(., na.rm = TRUE),
alta_vol = ~mean(.[alta_vol], na.rm = TRUE),
baja_vol = ~mean(.[!alta_vol], na.rm = TRUE),
alta_inf = ~mean(.[alta_inf], na.rm = TRUE),
baja_inf = ~mean(.[!alta_inf], na.rm = TRUE)
), .names = "{.col}_{.fn}")) |>
as_tibble() |>
pivot_longer(everything(), names_to = "nombre_variable", values_to = "valor") |>
separate(nombre_variable, into = c("grupo", "condicion1", "condicion2"), fill = "right", sep = "_") |>
mutate(
condicion = ifelse(is.na(condicion2), condicion1, paste(condicion1, condicion2, sep = "_"))
) %>%
dplyr::select(grupo, condicion, valor) |>
pivot_wider(
id_cols = grupo,
names_from = condicion,
values_from = valor
)
tabla_resultado |> clipr::write_clip()
df_full
df_full |>
rename("organimosMultilaterales" = organismos_multilaterales) |>
summarise(
across(bancos:otros, list(
total = ~mean(., na.rm = TRUE),
alta_vol = ~mean(.[alta_vol], na.rm = TRUE),
baja_vol = ~mean(.[!alta_vol], na.rm = TRUE),
alta_inf = ~mean(.[alta_inf], na.rm = TRUE),
baja_inf = ~mean(.[!alta_inf], na.rm = TRUE)
), .names = "{.col}_{.fn}"))
data_modelos
range(data_modelos$fecha)
eem <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf",
fecha >= "2009-06-01",
fecha <= "2024-11-01"
)
range(eem$fecha)
eem
eem |> glimpse()
eem_anclaje <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf",
fecha >= "2009-06-01",
fecha <= "2024-11-01") |>
select(fecha, horizonte, expectativa)
eem_anclaje <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf",
fecha >= "2009-06-01",
fecha <= "2024-11-01") |>
dplyr::select(fecha, horizonte, expectativa)
eem_anclaje
eem_anclaje <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf",
fecha >= "2009-06-01",
fecha <= "2024-11-01") |>
dplyr::select(fecha, horizonte, expectativa) |>
filter(horizonte %in% c("12 meses", "24 meses")) |>
pivot_wider(
id_cols = fecha,
names_from = horizonte,
values_from = expectativa
)
eem_anclaje
eem_anclaje <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf",
fecha >= "2009-06-01",
fecha <= "2024-11-01") |>
dplyr::select(fecha, horizonte, expectativa) |>
filter(horizonte %in% c("12 meses", "24 meses")) |>
pivot_wider(
id_cols = fecha,
names_from = horizonte,
values_from = expectativa
) |> janitor::clean_names()
eem_anclaje
eem_anclaje |> dplyr::filter(!is.na(x24_meses))
modelo_anclaje <- lm(x12_meses~x24_meses, data = eem_anclaje |>
dplyr::filter(!is.na(x24_meses)))
stargazer::stargazer(modelo_anclaje, type = "text")
modelo_anclaje <- lm(x24_meses~x12_meses, data = eem_anclaje |>
dplyr::filter(!is.na(x24_meses)))
stargazer::stargazer(modelo_anclaje, type = "text")
databcrd::get_expectativas(modalidad = "eem")
eem_anclaje <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf",
fecha >= "2009-06-01",
fecha <= "2024-11-01") |>
dplyr::select(fecha, horizonte, expectativa) |>
# filter(horizonte %in% c("12 meses", "24 meses")) |>
pivot_wider(
id_cols = fecha,
names_from = horizonte,
values_from = expectativa
) |> janitor::clean_names()
readRDS("data/eem_historico.rds")
readRDS("data/eem_historico.rds") |> glimpse()
# Estadisticos descriptivos en diferentes escenario -----------------------
grupos <- c("bancos", "organismos_multilaterales", "consultores", "otros")
# General
tabla_resumen <- function(data) {map_dfr(grupos, function(col) {
x <- data[[col]]
ref <- data$exp_inf
x_clean <- x[!is.na(x)]
tibble(
grupo = col,
media = mean(x, na.rm = TRUE),
varianza = var(x, na.rm = TRUE),
coef_var = sd(x, na.rm = TRUE) / mean(x, na.rm = TRUE),
correlacion = cor(x, ref, use = "complete.obs"),
autocor_1 = cor(x_clean[-length(x_clean)], x_clean[-1], use = "complete.obs"),
asimetria = skewness(x, na.rm = TRUE),
curtosis = kurtosis(x, na.rm = TRUE),
rango_intercuartil = IQR(x, na.rm = TRUE)
)
})}
tabla_resumen(data = expec_group) |>
clipr::write_clip()
tabla_resumen(data = expec_group)
expect_all <- readRDS("data/eem_historico.rds")
expect_all
expect_all |> glimpse()
expect_all |>
summarise(mensual = mean(inflacion_mes, na.rm = TRUE),
.by = periodo)
expectativas_mensual <- expect_all |>
summarise(mensual_anualizada = mean(inflacion_mes, na.rm = TRUE) * 12,
.by = periodo)
expectativas_mensual
databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf")
eem <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf")
inflacion <- databcrd::get_ipc_long(desagregacion = "general") |>
dplyr::mutate(
v_m = 100 * ((indice / lag(indice)) - 1),
v_i = 100 * ((indice / lag(indice, 12)) - 1)) |>
dplyr::select(date, ipc = indice, v_i)
data_plot <- eem |>
dplyr::left_join(inflacion, by = c("fecha" = "date"))
data_plot
data_plot |> glimpse()
expectativas_mensual
data_expectativas <- function(estadistico = "Promedio"){
checkmate::assert_choice(estadistico,
choices = c("Mediana","Promedio","Desviación estándar"))
eem <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf")
inflacion <- databcrd::get_ipc_long(desagregacion = "general") |>
dplyr::mutate(
v_m = 100 * ((indice / lag(indice)) - 1),
v_i = 100 * ((indice / lag(indice, 12)) - 1)) |>
dplyr::select(date, ipc = indice, v_i)
expectativas_mensual <- expect_all |>
summarise(expectativa = mean(inflacion_mes, na.rm = TRUE) * 12,
.by = periodo) |>
mutate(horizonte = "Mensual anualizada")
data_plot <- eem |>
dplyr::left_join(inflacion, by = c("fecha" = "date")) |>
cbind(expectativas_mensual)
data_plot
}
data_expectativas("Promedio")
data_expectativas("Promedio") |> glimpse()
data_expectativas <- function(estadistico = "Promedio"){
checkmate::assert_choice(estadistico,
choices = c("Mediana","Promedio","Desviación estándar"))
eem <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf")
inflacion <- databcrd::get_ipc_long(desagregacion = "general") |>
dplyr::mutate(
v_m = 100 * ((indice / lag(indice)) - 1),
v_i = 100 * ((indice / lag(indice, 12)) - 1)) |>
dplyr::select(date, ipc = indice, v_i)
expectativas_mensual <- expect_all |>
summarise(expectativa = mean(inflacion_mes, na.rm = TRUE) * 12,
.by = periodo) |>
mutate(horizonte = "Mensual anualizada")
data_plot <- eem |>
dplyr::left_join(inflacion, by = c("fecha" = "date")) |>
bind_cols(expectativas_mensual)
data_plot
}
promedio <- data_expectativas("Promedio")
eem <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf")
inflacion <- databcrd::get_ipc_long(desagregacion = "general") |>
dplyr::mutate(
v_m = 100 * ((indice / lag(indice)) - 1),
v_i = 100 * ((indice / lag(indice, 12)) - 1)) |>
dplyr::select(date, ipc = indice, v_i)
expectativas_mensual <- expect_all |>
summarise(expectativa = mean(inflacion_mes, na.rm = TRUE) * 12,
.by = periodo) |>
mutate(horizonte = "Mensual anualizada")
eem |>
dplyr::left_join(inflacion, by = c("fecha" = "date")) |>
bind_cols(expectativas_mensual)
expectativas_mensual
data_plot <- eem |>
dplyr::left_join(inflacion, by = c("fecha" = "date")) |>
bind_rows(expectativas_mensual)
data_plot
data_plot |> glimpse()
data_plot |> distinct(horizonte)
promedio <- data_expectativas("Promedio")
data_expectativas <- function(estadistico = "Promedio"){
checkmate::assert_choice(estadistico,
choices = c("Mediana","Promedio","Desviación estándar"))
eem <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf")
inflacion <- databcrd::get_ipc_long(desagregacion = "general") |>
dplyr::mutate(
v_m = 100 * ((indice / lag(indice)) - 1),
v_i = 100 * ((indice / lag(indice, 12)) - 1)) |>
dplyr::select(date, ipc = indice, v_i)
expectativas_mensual <- expect_all |>
summarise(expectativa = mean(inflacion_mes, na.rm = TRUE) * 12,
.by = periodo) |>
mutate(horizonte = "Mensual anualizada")
data_plot <- eem |>
dplyr::left_join(inflacion, by = c("fecha" = "date")) |>
bind_rows(expectativas_mensual)
data_plot
}
promedio <- data_expectativas("Promedio")
promedio |>
left_join(data_ms |> dplyr::select(fecha, meta)) |>
ggplot(aes(fecha, expectativa)) +
geom_line(aes(color = horizonte)) +
geom_line(aes(y = v_i, color = "Inflación observada"), size = 0.7) +
geom_line(aes(y = meta), color = "darkred", linetype = 8) +
geom_line(aes(y = meta + 1), color = "darkred") +
geom_line(aes(y = meta - 1), color = "darkred") +
# geom_hline(yintercept = 4, color = "gray") +
# geom_hline(yintercept = c(5, 3), color = "gray", linetype = 2) +
labs(color = NULL, x = NULL, y = NULL) +
theme_light() +
theme(
legend.position = "top",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
promedio
promedio |> glimpse()
data_expectativas <- function(estadistico = "Promedio"){
checkmate::assert_choice(estadistico,
choices = c("Mediana","Promedio","Desviación estándar"))
eem <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf")
inflacion <- databcrd::get_ipc_long(desagregacion = "general") |>
dplyr::mutate(
v_m = 100 * ((indice / lag(indice)) - 1),
v_i = 100 * ((indice / lag(indice, 12)) - 1)) |>
dplyr::select(date, ipc = indice, v_i)
expectativas_mensual <- expect_all |>
dplyr::summarise(expectativa = mean(inflacion_mes, na.rm = TRUE) * 12,
.by = periodo) |>
dplyr::rename("fecha" = periodo) |>
dplyr::mutate(horizonte = "Mensual anualizada")
data_plot <- eem |>
dplyr::left_join(inflacion, by = c("fecha" = "date")) |>
bind_rows(expectativas_mensual)
data_plot
}
promedio <- data_expectativas("Promedio")
promedio |>
left_join(data_ms |> dplyr::select(fecha, meta)) |>
ggplot(aes(fecha, expectativa)) +
geom_line(aes(color = horizonte)) +
geom_line(aes(y = v_i, color = "Inflación observada"), size = 0.7) +
geom_line(aes(y = meta), color = "darkred", linetype = 8) +
geom_line(aes(y = meta + 1), color = "darkred") +
geom_line(aes(y = meta - 1), color = "darkred") +
# geom_hline(yintercept = 4, color = "gray") +
# geom_hline(yintercept = c(5, 3), color = "gray", linetype = 2) +
labs(color = NULL, x = NULL, y = NULL) +
theme_light() +
theme(
legend.position = "top",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
data_expectativas <- function(estadistico = "Promedio"){
checkmate::assert_choice(estadistico,
choices = c("Mediana","Promedio","Desviación estándar"))
eem <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == estadistico,
variable_key == "inf")
inflacion <- databcrd::get_ipc_long(desagregacion = "general") |>
dplyr::mutate(
v_m = 100 * ((indice / lag(indice)) - 1),
v_i = 100 * ((indice / lag(indice, 12)) - 1)) |>
dplyr::select(date, ipc = indice, v_i)
data_plot <- eem |>
dplyr::left_join(inflacion, by = c("fecha" = "date"))
data_plot
}
promedio <- data_expectativas("Promedio")
promedio |>
left_join(data_ms |> dplyr::select(fecha, meta)) |>
ggplot(aes(fecha, expectativa)) +
geom_line(aes(color = horizonte)) +
geom_line(aes(y = v_i, color = "Inflación observada"), size = 0.7) +
geom_line(aes(y = meta), color = "darkred", linetype = 8) +
geom_line(aes(y = meta + 1), color = "darkred") +
geom_line(aes(y = meta - 1), color = "darkred") +
# geom_hline(yintercept = 4, color = "gray") +
# geom_hline(yintercept = c(5, 3), color = "gray", linetype = 2) +
labs(color = NULL, x = NULL, y = NULL) +
theme_light() +
theme(
legend.position = "top",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
stargazer::stargazer(modelo_anclaje, type = "text")
stargazer::stargazer(mod_covid, mod_covid2, type = "text")
range(data_modelos$fecha)
stargazer::stargazer(modelo_anclaje, type = "text")
estadistico
eem_anclaje <- databcrd::get_expectativas(modalidad = "eem") |>
dplyr::filter(
medida == "Promedio",
variable_key == "inf",
fecha >= "2009-06-01",
fecha <= "2024-11-01") |>
dplyr::select(fecha, horizonte, expectativa) |>
# filter(horizonte %in% c("12 meses", "24 meses")) |>
pivot_wider(
id_cols = fecha,
names_from = horizonte,
values_from = expectativa
) |> janitor::clean_names()
modelo_anclaje <- lm(x24_meses~x12_meses, data = eem_anclaje |>
dplyr::filter(!is.na(x24_meses)))
stargazer::stargazer(modelo_anclaje, type = "text")
